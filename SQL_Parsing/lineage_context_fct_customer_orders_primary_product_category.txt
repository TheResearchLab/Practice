üéØ ENHANCED COLUMN LINEAGE FLOW:
============================================================
üìç SOURCE: external_catalog_db.products.product_info.category (external_database)
      ‚Üì
   [FLOWS TO]
      ‚Üì
‚öôÔ∏è TABLE: stg_products.product_category (calculated)
    ‚îî‚îÄ UPPER(TRIM(category)) AS product_category
      ‚Üì
   [FLOWS TO]
      ‚Üì
üìù TABLE: wrk_orders_final.product_category (direct)
    ‚îî‚îÄ p.product_category
      ‚Üì
   [FLOWS TO]
      ‚Üì
üìù TABLE: customer_order_summary.primary_product_category (via CTE transformations)
    üîÑ CTE 'customer_metrics' processes primary_product_category
    ‚îî‚îÄ cm.primary_product_category
      ‚Üì
   [FLOWS TO]
      ‚Üì
üìù TABLE: fct_customer_orders.primary_product_category (direct)
    ‚îî‚îÄ co.primary_product_category

================================================================================
COLUMN LINEAGE TECHNICAL ANALYSIS
================================================================================
TARGET COLUMN: fct_customer_orders.primary_product_category
COMPLEXITY LEVEL: MEDIUM
DEVELOPMENT RISK: LOW
TRANSFORMATION STEPS: 4
SOURCE TABLES: 1
AGGREGATION POINTS: 0

ULTIMATE DATA SOURCES:
  ‚Ä¢ external_catalog_db.products.product_info.category

DETAILED TRANSFORMATION ANALYSIS:
--------------------------------------------------

STEP 1: TRANSFORMATION
  Table: fct_customer_orders
  Column: primary_product_category
  SQL File: compiled\order\fct_customer_orders.sql
  Transformation Context: INTER-FILE (table-to-table)
  SQL Expression: co.primary_product_category
  Transformation Type: direct
  Complexity Level: LOW - Direct column reference
  Performance Impact: Minimal performance impact
  Data Scope: Direct transformation from single source

STEP 2: TRANSFORMATION
  Table: customer_order_summary
  Column: primary_product_category
  SQL File: compiled\order\customer_order_summary.sql
  CTE Logic: CTE 'customer_metrics' processes primary_product_category
  Transformation Context: INTRA-FILE (contains CTE logic)
  SQL Expression: cm.primary_product_category
  Transformation Type: direct
  Complexity Level: LOW - Direct column reference
  Performance Impact: Minimal performance impact
  Data Scope: Direct transformation from single source

STEP 3: TRANSFORMATION
  Table: wrk_orders_final
  Column: product_category
  SQL File: compiled\order\wrk_orders_final.sql
  Transformation Context: INTER-FILE (table-to-table)
  SQL Expression: p.product_category
  Transformation Type: direct
  Complexity Level: LOW - Direct column reference
  Performance Impact: Minimal performance impact
  Data Scope: Direct transformation from single source

STEP 4: TRANSFORMATION
  Table: stg_products
  Column: product_category
  SQL File: compiled\product\stg_products.sql
  Transformation Context: INTER-FILE (table-to-table)
  SQL Expression: UPPER(TRIM(category)) AS product_category
  Transformation Type: calculated
  Complexity Level: MEDIUM - Calculated transformation
  Performance Impact: Moderate computational overhead
  Data Scope: Direct transformation from single source

STEP 5: SOURCE TABLE
  Table: external_catalog_db.products.product_info
  Column: category
  Source Type: external_database
  Business Impact: Source of truth for this data element

================================================================================
USE CASE SPECIFIC GUIDANCE
================================================================================

FOR DOCUMENTATION GENERATION:
- Source column comments should be retrieved for: external_catalog_db.products.product_info.category
- Data grain changes occur at 0 aggregation points
- Business logic complexity: MEDIUM

FOR ISSUE INVESTIGATION:

FOR DEVELOPMENT PLANNING:
- Change impact scope: 4 models affected
- Testing complexity: LOW due to transformation complexity